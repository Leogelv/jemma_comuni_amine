/* ========================================
   ГЛОБАЛЬНЫЕ СТИЛИ: Anti Self-Deception
   Apple Beautiful Light Design System
   ======================================== */

/* Импорт дизайн-токенов и анимаций */
@import "./tokens.css";
@import "./animations.css";

/* ========================================
   CSS ПЕРЕМЕННЫЕ: Telegram Safe Area Fallbacks
   Перезаписываются из TelegramContext при инициализации SDK
   ======================================== */

:root {
  /* Telegram SDK safe area переменные (fallback на browser env()) */
  --tg-safe-area-inset-top: env(safe-area-inset-top, 0px);
  --tg-safe-area-inset-bottom: env(safe-area-inset-bottom, 0px);
  --tg-safe-area-inset-left: env(safe-area-inset-left, 0px);
  --tg-safe-area-inset-right: env(safe-area-inset-right, 0px);
  --tg-content-safe-area-inset-top: 0px;
  --tg-content-safe-area-inset-bottom: 0px;
  /* Комбинированные отступы (notch + Telegram UI) */
  --tg-total-safe-area-top: env(safe-area-inset-top, 0px);
  --tg-total-safe-area-bottom: env(safe-area-inset-bottom, 0px);
}

/* ========================================
   БАЗОВЫЕ СТИЛИ — Светлая Apple-тема
   ======================================== */

* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

html {
  height: 100%;
}

body {
  height: 100%;
  overflow: hidden; /* Блокируем скролл body — весь скролл внутри .app-screen */
  font-family: var(--font-family);
  background: var(--color-bg-secondary);
  color: var(--color-text);
  -webkit-tap-highlight-color: transparent;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  line-height: 1.5;
  letter-spacing: -0.01em;
}

/* ========================================
   APP SCREEN — Основной контейнер приложения
   Фиксированный блок с safe area отступом сверху,
   внутри которого скроллится контент
   ======================================== */

.app-screen {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  display: flex;
  flex-direction: column;
  background: white;
}

/* Верхний отступ для Telegram safe area */
.app-screen.with-safe-area {
  padding-top: max(12px, var(--tg-total-safe-area-top, 0px));
}

.app-screen.with-safe-area-desktop {
  padding-top: max(55px, calc(var(--tg-total-safe-area-top, 0px) + 40px));
}

/* Скроллируемая область внутри app-screen */
.app-screen__scroll {
  flex: 1;
  overflow-y: auto;
  overflow-x: hidden;
  -webkit-overflow-scrolling: touch;
  overscroll-behavior: contain;
}

/* ========================================
   ТИПОГРАФИКА — Apple-style
   ======================================== */

h1, h2, h3, h4, h5, h6 {
  font-weight: 700;
  letter-spacing: -0.02em;
  color: var(--color-text);
}

h1 { font-size: 34px; line-height: 1.2; }
h2 { font-size: 28px; line-height: 1.25; }
h3 { font-size: 22px; line-height: 1.3; }
h4 { font-size: 20px; line-height: 1.35; }

p {
  color: var(--color-text-secondary);
  line-height: 1.5;
}

/* ========================================
   TELEGRAM MINI APP: Safe Areas
   ======================================== */

/* Legacy — для обратной совместимости */
.with-safe-area-top {
  padding-top: env(safe-area-inset-top, 0px);
}

.with-safe-area-bottom {
  padding-bottom: env(safe-area-inset-bottom, 0px);
}

/* ===== Telegram Safe Area System ===== */
/* Используй эти классы для всех страниц и модалок */

/* Основной контейнер страницы с safe area отступами */
.tg-safe-page {
  padding-top: max(12px, var(--tg-total-safe-area-top, 0px));
  padding-bottom: max(2px, var(--tg-total-safe-area-bottom, 0px));
}

/* Desktop версия с увеличенным верхним отступом */
.tg-safe-page-desktop {
  padding-top: max(55px, calc(var(--tg-total-safe-area-top, 0px) + 40px));
  padding-bottom: max(2px, var(--tg-total-safe-area-bottom, 0px));
}

/* Только верхний отступ */
.tg-safe-top {
  padding-top: max(12px, var(--tg-total-safe-area-top, 0px));
}

/* Только нижний отступ */
.tg-safe-bottom {
  padding-bottom: max(2px, var(--tg-total-safe-area-bottom, 0px));
}

/* ========================================
   УТИЛИТЫ
   ======================================== */

/* Скрытие скроллбара */
.no-scrollbar::-webkit-scrollbar {
  display: none;
}
.no-scrollbar {
  -ms-overflow-style: none;
  scrollbar-width: none;
}

/* Touch-friendly scrolling для iOS */
.scroll-touch {
  -webkit-overflow-scrolling: touch;
  scroll-behavior: smooth;
  overscroll-behavior: contain;
}

/* touch-action только для реальных тач-устройств без hover (мобильные)
   Условие (hover: none) исключает Desktop Telegram где pointer: coarse может срабатывать неправильно */
@media (hover: none) and (pointer: coarse) {
  .scroll-touch {
    touch-action: pan-y pinch-zoom;
  }
}

/* Контейнер с ограниченной шириной */
.container {
  max-width: var(--content-max-width);
  margin: 0 auto;
  padding: 0 var(--spacing-md);
}

/* Карточка в светлом стиле */
.card {
  background: var(--card-bg);
  border-radius: var(--radius-xl);
  box-shadow: var(--card-shadow);
  transition: box-shadow var(--transition-base);
}

.card:hover {
  box-shadow: var(--card-shadow-hover);
}

/* ========================================
   КНОПКИ
   ======================================== */

button {
  font-family: inherit;
  cursor: pointer;
  border: none;
  background: none;
  -webkit-tap-highlight-color: transparent;
}

/* ========================================
   ФОКУСНЫЕ СТИЛИ (Accessibility)
   ======================================== */

:focus-visible {
  outline: 2px solid var(--color-accent);
  outline-offset: 2px;
}

/* ========================================
   SELECTION
   ======================================== */

::selection {
  background: var(--color-accent-bg);
  color: var(--color-accent);
}
